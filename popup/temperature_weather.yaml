action: fire-dom-event
browser_mod:
  command: popup
  title: Météo
  style:
    .: |
      :host .content {
        width: calc(400px + 400px);
        max-width: 90vw;
      }
    layout-card:
      $grid-layout$:
        hui-entities-card:
          $: |
            .card-content {
              padding: 1.5em 1em 2.3em 1em;
            }
            ha-card {
              animation: border 1s forwards;
              border-radius: 0;
            }
            @keyframes border {
              0%, 100% {
                border-right: 1px solid rgba(0, 0, 0, 0.3);
              }
            }
            /* phone */
            @media screen and (max-width: 800px) {
              ha-card {
                animation: none;
              }
            }
          $hui-horizontal-stack-card$: |
            #root {
              justify-content: space-evenly;
              margin-top: 1.9em;
              margin-left: 0.8em;
            }
  card:
    type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      grid-template-columns: repeat(2, 1fr)
      grid-template-rows: 1fr
      grid-template-areas: |
        "part1 part2"
      mediaquery:
        #phone
        "(max-width: 800px)":
          grid-template-columns: 1fr
          grid-template-rows: repeat(2, 1fr)
          grid-template-areas: |
            "part1"
            "part2"
    cards:

      #################################################
      #                                               #
      #                SYSTEM AND NETWORK             #
      #                                               #
      #################################################

      - type: entities
        view_layout:
          grid-area: part1
        show_header_toggle: false
        card_mod:
          class: header
          style: |
            ha-card {
              margin: 0px !important;
            }
        entities:

          - type: custom:hui-vertical-stack-card
            cards:

              - type: weather-forecast
                entity: weather.villeneuve_d_ascq

        footer:
          type: custom:mini-graph-card
          entities:
            - color: '#385581'
              entity: sensor.template_weather_temperature
              name: Température
            - color: green
              entity: sensor.template_weather_humidity
              name: Humidité
              y_axis: secondary
          align_state: left
          line_width: 4
          group: false
          points_per_hour: 1
          hour24: true
          hours_to_show: 24
          height: 200
          show:
            {fill: fade, icon: false, name: false, state: false, name_adaptive_color: true, labels: hover, legend: true}
          tap_action:
            action: none

      #################################################
      #                                               #
      #                    SERVICE                    #
      #                                               #
      #################################################

      - type: entities
        view_layout:
          grid-area: part2
        show_header_toggle: false
        card_mod:
          class: header
          style: |
            ha-card {
              margin: 0px !important;
            }
        entities:

          - type: custom:hui-vertical-stack-card
            cards:

              - type: iframe
                url: >-
                  https://embed.windy.com/embed2.html?lat=50.463&lon=2.920&detailLat=49.304&detailLon=1.983&width=650&height=450&zoom=7&level=surface&overlay=wind&product=ecmwf&menu=&message=&marker=&calendar=now&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                aspect_ratio: 100%

          - type: custom:hui-horizontal-stack-card
            cards:

              - type: custom:button-card
                name: Ouvrir Windy.com
                icon: mdi:open-in-new
                template: icon_name
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    command: popup
                    title: Windy
                    style: >
                      :host .content {
                        width: 85em;
                      }
                    card:
                      type: iframe
                      url: https://embed.windy.com
                      aspect_ratio: 75%
                      style: |
                        ha-card {
                          border-radius: 0 0 1em 1em;
                        }
